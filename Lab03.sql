/*BANCO DE DADOS I
LAB03 
MARCELO DOLABELLA*/

--1)
SELECT P.NOM_PROJETO,D.NOM_DEPTO
FROM BD_EMPRESA.PROJETO AS P INNER JOIN BD_EMPRESA.DEPARTAMENTO AS D
ON P.COD_DEPTO = D.COD_DEPTO

--2)
SELECT E.NUM_MATRICULA,E.NOM_EMPREGADO,D.NOM_DEPTO
FROM BD_EMPRESA.EMPREGADO AS E INNER JOIN BD_EMPRESA.DEPARTAMENTO AS D
ON E.COD_DEPTO = D.COD_DEPTO

--3)
SELECT E.NOM_EMPREGADO, D.NOM_DEPTO
FROM BD_EMPRESA.EMPREGADO AS E INNER JOIN BD_EMPRESA.DEPARTAMENTO AS D
ON D.NUM_MATRICULA_GERENTE = E.NUM_MATRICULA

--4)
SELECT E.NOM_EMPREGADO, D.NOM_DEPENDENTE
FROM BD_EMPRESA.EMPREGADO AS E INNER JOIN BD_EMPRESA.DEPENDENTE AS D
ON D.NUM_MATRICULA = E.NUM_MATRICULA

--5)
SELECT E.NOM_EMPREGADO, SUP.NOM_EMPREGADO AS SUPERVISOR
FROM BD_EMPRESA.EMPREGADO AS E INNER JOIN BD_EMPRESA.EMPREGADO AS SUP
ON E.NUM_MATRICULA_SUPERVISOR = SUP.NUM_MATRICULA

--6)
SELECT E.NUM_MATRICULA, E.NOM_EMPREGADO, D.NOM_DEPTO, D.NUM_MATRICULA_GERENTE
FROM BD_EMPRESA.EMPREGADO AS E INNER JOIN BD_EMPRESA.DEPARTAMENTO AS D
ON D.COD_DEPTO = E.COD_DEPTO

--7)
SELECT E.NUM_MATRICULA_SUPERVISOR, SUP.NOM_EMPREGADO 
FROM BD_EMPRESA.EMPREGADO AS E INNER JOIN BD_EMPRESA.EMPREGADO AS SUP
ON E.NUM_MATRICULA_SUPERVISOR = SUP.NUM_MATRICULA

--8)
SELECT E.NOM_EMPREGADO, SUP.NOM_EMPREGADO AS SUPERVISOR
FROM BD_EMPRESA.EMPREGADO AS E LEFT JOIN BD_EMPRESA.EMPREGADO AS SUP
ON SUP.NUM_MATRICULA = E.NUM_MATRICULA_SUPERVISOR

--9)
SELECT E.NOM_EMPREGADO, ISNULL(D.NOM_DEPTO, '(nao encontrado)') AS DEPARTAMENTO_QUE_GERENCIA
FROM BD_EMPRESA.EMPREGADO AS E LEFT JOIN BD_EMPRESA.DEPARTAMENTO AS D 
ON D.NUM_MATRICULA_GERENTE = E.NUM_MATRICULA

--10)
SELECT E.NOM_EMPREGADO , D.NOM_DEPENDENTE
FROM BD_EMPRESA.EMPREGADO AS E LEFT JOIN BD_EMPRESA.DEPENDENTE AS D
ON D.NUM_MATRICULA = E.NUM_MATRICULA

--11)
SELECT D.NOM_DEPTO , E.NOM_EMPREGADO
FROM BD_EMPRESA.DEPARTAMENTO AS D LEFT JOIN BD_EMPRESA.EMPREGADO AS E
ON E.COD_DEPTO = D.COD_DEPTO

--12)
SELECT P.COD_PROJETO, P.NOM_PROJETO
FROM BD_EMPRESA.PROJETO AS P FULL OUTER JOIN BD_EMPRESA.ALOCACAO AS A
ON P.COD_PROJETO = A.COD_PROJETO
WHERE A.COD_PROJETO = NULL

--13)
SELECT E.NUM_MATRICULA, E.NOM_EMPREGADO
FROM BD_EMPRESA.EMPREGADO AS E FULL OUTER JOIN BD_EMPRESA.DEPARTAMENTO AS D
ON D.NUM_MATRICULA_GERENTE = E.NUM_MATRICULA
WHERE D.NUM_MATRICULA_GERENTE = NULL

--14)
SELECT E.NUM_MATRICULA, E.NOM_EMPREGADO, D.NOM_DEPTO, SUP.NUM_MATRICULA AS NUM_MATRICULA_GERENTE, SUP.NOM_EMPREGADO AS GERENTE
FROM BD.EMPRESA.EMPREGADO AS E
	INNER JOIN BD_EMPRESA.DEPARTARMENTO AS D ON D.COD_DEPTO = E.COD_DEPTO
	INNER JOIN BD_EMPRESA.EMPREGADO AS SUP ON D.NUM_MATRICULA_GERENTE = SUP.NUM_MATRICULA

--15)
SELECT D.NOM_DEPTO, SUP.NOM_EMPREGADO AS GERTENTE, DL.NOM_LOCAL
FROM BD.EMPRESA.DEPARTAMENTO AS D
	INNER JOIN BD_EMPRESA.EMPREGADO AS E ON D.NUM_MATRICULA_GERENTE = SUP.NUM_MATRICULA
	INNER JOIN BD_EMPRESA.DEPARTAMENTO_LOCAL AS DL ON DL.COD_DEPTO = D.COD_DEPTO

--16)
SELECT P.NOM_PROJETO, D.NOM_DEPTO, E.NOM_EMPREGADO, A.NUM_HORAS
FROM BD.EMPRESA.PROJETO AS P
	INNER JOIN BD_EMPRESA.DEPARTAMENTO AS D ON P.COD_DEPTO = D.COD_DEPTO
	INNER JOIN BD_EMPRESA.EMPREGADO AS E ON E.COD_DEPTO = P.COD_DEPTO
	INNER JOIN BD_EMPRESA.ALOCACAO AS A ON E.NUM_MATRICULA = A.NUM_MATRICULA
		AND A.COD_PROJETO = P.COD_PROJETO

--17)
SELECT E.NOM_EMPREGADO, D.NOM_DEPTO, SUP.NOM_EMPREGADO AS GERENTE, A.NUM_HORAS, P.NOM_PROJETO, D.NOM_DEPTO
FROM BD.EMPRESA.EMPREGADO AS E
	INNER JOIN BD_EMPRESA.DEPARTAMENTO AS D ON D.COD_DEPTO = E.COD_DEPTO
	INNER JOIN BD_EMPRESA.EMPREGADO AS GER ON D.NUM_MATRICULA_GERENTE = GER.NUM_MATRICULA
	INNER JOIN BD_EMPRESA.ALOCACAO AS A ON A.NUM_MATRICULA = E.NUM_MATRICULA
	INNER JOIN BD_EMPRESA.PROJETO AS P ON P.COD_PROJETO = A.COD_PROJETO AND P.COD_DEPTO = D.COD_DEPTO

--18)
SELECT E.NOM_EMPREGADO, D.NOM_DEPTO, GER.NOM_EMPREGADO, A.NUM_HORAS, P.NOM_PROJETO, D.NOM_DEPTO
FROM BD.EMPRESA.EMPREGADO AS E
	INNER JOIN BD_EMPRESA.DEPARTAMENTO AS D ON D.COD_DEPTO = E.COD_DEPTO
	INNER JOIN BD_EMPRESA.EMPREGADO AS GER ON D.NUM_MATRICULA_GERENTE = GER.NUM_MATRICULA
	INNER JOIN BD_EMPRESA.ALOCACAO AS A ON A.NUM_MATRICULA = E.NUM_MATRICULA
	INNER JOIN BD_EMPRESA.PROJETO AS P ON P.COD_DEPTO = D.COD_DEPTO AND P.COD_DEPTO <> E.COD_DEPTO

--19)
SELECT E.NOM_EMPREGADO, SUP.NOM_EMPREGADO AS SUPERVISOR
FROM BD.EMPRESA.EMPREGADO AS E INNER JOIN BD_EMPRESA.EMPREGADO AS SUP ON E.NUM_MATRICULA_SUPERVISOR = SUP.NUM_MATRICULA
WHERE SUPERVISOR NOT LIKE 'JOSÃ‰%'
